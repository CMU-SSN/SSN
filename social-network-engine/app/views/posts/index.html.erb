<% content_for :header do %>
    <h3>All Posts</h3>
    <!--Commenting out for the demo this week, let's not show anything that doesn't work - BB-->
    <!--a href="needs.html.erb" class="ui-btn-right" data-icon="grid" data-theme="c">Needs</a-->
<% end %>
<% content_for :content do %>
    <div class="feed-item">
	Quick Status:
	<a class="update-status" data-role="button" data-inline="true" data-theme="b" data-mini="true" data-icon="ssn-good" value="<%= Post::GOOD_STATUS %>">Good</a>
	<a class="update-status" data-role="button" data-inline="true" data-theme="b" data-mini="true" data-icon="ssn-exclamation" value="<%= Post::HELP_STATUS %>">Help</a>
	<a class="update-status" data-role="button" data-inline="true" data-theme="b" data-mini="true" data-icon="ssn-exclamation-red" value="<%= Post::IMMEDIATE_HELP_STATUS %>">Need Immediate Help</a>
    </div>

    <div class="feed-item">
      <%= form_for @post, :url => {:action => "create"}, :html => {:method => :post, :class => "new-post"} do |f| %>
          <%= f.hidden_field :latitude %>
          <%= f.hidden_field :longitude %>		  
		  <%= f.hidden_field :status, :value => "false" %>
          <%= f.text_area :text, :placeholder => "Enter new posts here" %>
          <%= f.submit "Post", :id => "submit-post", :data => {:role => "button", :theme => "b"} %>
      <% end %>
    </div>
    <div id="posts" data-token="<%= @token %>">
      <% if !@posts.nil? && @posts.length > 0 %>
          <% @posts.each do |post| %>
              <%= render "partials/feed_item", :post => post %>
          <% end %>
      <% else %>
          <div class="feed-item">
            No posts yet.
          </div>
      <% end %>
    </div>

<% end %>

<% content_for :scripts do %>
    <script id="postTemplate" type="text/x-jsrender">
      <div class="feed-item">
        <a class="feed-top">
          <img src="{{>creator_pic}}" class="feed-user-image">

          <div class="feed-heading">
            <h2 class="feed-name">
              {{>creator_name}}
            </h2>

            <p class="feed-time">
              {{if city || zipcode}}
                <abbr class="timeago" title="{{>updated_at}}">{{>updated_at}}</abbr> near {{>city}} {{>zipcode}}
              {{else}}
                <abbr class="timeago" title="{{>updated_at}}">{{>updated_at}}</abbr>
              {{/if}}
            </p>
          </div>
        </a>

        <div>
          {{if !status}}
              <p class="feed-text">
                {{>text}}
              </p>
          {{else text == "Good"}}
              <div class="status-green">
                <img alt="{{>text}}" class="status-img" src="/assets/status-check.png"/>
                <h4 class="status-text">Quick Status - {{>text}}</h4>
              </div>
          {{else text == "Help"}}
              <div class="status-yellow">
                <img alt="{{>text}}" class="status-img" src="/assets/help.png"/>
                <h4 class="status-text">Quick Status - {{>text}}</h4>
              </div>
          {{else text == "Need Immediate Help"}}
              <div class="status-red">
                <img alt="{{>text}}" class="status-img" src="/assets/help.png"/>
                <h4 class="status-text">Quick Status - {{>text}}</h4>
              </div>
          {{/if}}
        </div>
      </div>
    </script>

    <%= javascript_include_tag 'post/post' %>
<% end %>



